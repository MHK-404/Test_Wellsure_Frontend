<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wellsure</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Quick inline styles to make it nicer */
    .hidden { display: none; }
    #loading { font-weight: bold; margin-top: 20px; }
    .container { max-width: 600px; margin: auto; padding: 20px; }
    form label { display: block; margin-top: 10px; }
    form input, form textarea { width: 100%; margin-top: 5px; padding: 8px; }
    button { margin-top: 15px; padding: 10px 20px; }
    #results ul { list-style-type: disc; padding-left: 20px; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Welcome Section -->
    <header>
      <h1>Welcome to Wellsure</h1>
      <p>Your personalized health insurance risk assessment tool.</p>
    </header>

    <!-- Form Section -->
    <form id="assessmentForm">
      <section class="section">
        <h2>Physical Health</h2>
        <label for="weight">Weight (kg):</label>
        <input type="number" id="weight" name="weight" required>

        <label for="height">Height (m):</label>
        <input type="number" id="height" name="height" required>

        <label for="chronicDisorders">Do you have any chronic disorders?</label>
        <input type="text" id="chronicDisorders" name="chronicDisorders" required>

        <label for="physicalHealthScore">Physical Health Score (1-100):</label>
        <input type="number" id="physicalHealthScore" name="physicalHealthScore" required>
      </section>

      <section class="section">
        <h2>Mental Health</h2>
        <label for="mentalHealthScore">Mental Health Score (1-100):</label>
        <input type="number" id="mentalHealthScore" name="mentalHealthScore" required>

        <label for="textQuestion1">How have you been feeling the last 7 days?</label>
        <textarea id="textQuestion1" name="textQuestion1" required></textarea>

        <label for="textQuestion2">Describe the environment you live in.</label>
        <textarea id="textQuestion2" name="textQuestion2" required></textarea>
      </section>

      <button type="submit">Submit</button>
    </form>

    <div id="loading" class="hidden">Processing your assessment...</div>

    <!-- Results Section -->
    <section id="results" class="hidden">
      <h2>Your Results</h2>
      <p><strong>Your Risk Score:</strong> <span id="riskScore"></span></p>
      <p><strong>Your BMI:</strong> <span id="bmi"></span></p>

      <h3>Recommendations:</h3>
      <ul id="recommendations"></ul>

      <h3>AI Feedback:</h3>
      <p id="textFeedback"></p>
    </section>
  </div>

  <script>
    const form = document.getElementById('assessmentForm');
    const resultsSection = document.getElementById('results');
    const loadingIndicator = document.getElementById('loading');
    const riskScoreElement = document.getElementById('riskScore');
    const bmiElement = document.getElementById('bmi');
    const recommendationsElement = document.getElementById('recommendations');
    const textFeedbackElement = document.getElementById('textFeedback');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      loadingIndicator.classList.remove('hidden');
      resultsSection.classList.add('hidden');

      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('https://test-wellsure-back-ancbame0gwg5ccfu.uaenorth-01.azurewebsites.net/submit', {
          method: 'POST',
          body: JSON.stringify(data),
          headers: {
            'Content-Type': 'application/json'
          }
        });

        const result = await response.json();

        // Update Results
        riskScoreElement.textContent = result.riskScore;
        bmiElement.textContent = result.bmi;

        recommendationsElement.innerHTML = result.recommendations
          .split('\n')
          .filter(line => line.trim() !== '')
          .map(line => `<li>${line.trim()}</li>`)
          .join('');

        textFeedbackElement.textContent = result.textFeedback;

        loadingIndicator.classList.add('hidden');
        resultsSection.classList.remove('hidden');
      } catch (error) {
        console.error('Error submitting form:', error);
        alert('There was an error submitting your assessment. Please try again later.');
        loadingIndicator.classList.add('hidden');
      }
    });
  </script>
</body>
</html>
